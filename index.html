</div><!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Modern Table Design</title>
  <link href="https://fonts.googleapis.com/css2?family=Segoe+UI&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet" />
 <!-- Load Choices first -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/choices.js/public/assets/styles/choices.min.css" />

<!-- Then load your overrides -->
<link rel="stylesheet" href="style.css" />

</head>
<body>
  <div class="dashboard-container">
    <div class="header">
      <div class="title-with-logo">
        <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAU4AAACXCAMAAABNy0IIAAAAxlBMVEX///8AhcoAMIcAg8kAfscAfccAesYAgMgAgskAKoXC2u4AHYEAAHsALYYAecYAF3+zudFPYp4AJ4Q1T5UAFn+pscwAEn7L0OAAK4UAJINEmdJ+s93Bx9v3+v0fi8zU1+Soy+fi5e620+tre6ybxOTv8fZmp9je7PYAC33g4+1GW5swks8AcsOy0epwrdqEkLjQ4/KbpMR2hLHm8PiUnsBfcaePveFmdqqIlLpXaaJBl9Guts84UZZ7iLOWoMFIXZwmRJAYO4zkKWPMAAAaGUlEQVR4nO1dB3uqyhYdQ7O3BIkKIiqWmNhiN6b8/z/1Zk+hYzSad869l/V95wRxGGDNnt1mgwglSJAgQYIECRIkSJAgQYIECRIkSJAgQYIECRL852Br+tzUdIQWNhq963/6cv7RMN7QSH+y0byC7JJtbuzDFo26yz99Wf882OR/86gi1EVoPrXVrb3Be3aogkZTVJnbf/b6/lEod98/LPxXNVYGmmLpNOfbg71DQOd8Ydta2V7ZycQ/D0tDNYE4hI7H5RHNR2hudVXVWmrI3JqG/WFv58YR2DX/9KX+9dDfkbU0Fgit8Ac8vaeGaSHLsAzbQMvFFs9/tLVW1lLXjwhPfM340xf8d8P6WGEWd0AVQlpEA3Op21v8d2V2dzraLbYJoXGYVkAiN0dd3XSt003tBeiDrY6sKM4TAFSzgnQdqUfkFznDgLnu32Uj64i6atdGy0qiQyOhq8cnY+XZYZWX3bdCfgjI174qR1VzPSTbwMKJbLuL5of//7X+1dC7YMmtBTJUvms03z3UcvXqY+GOoZCp50rDr0WZS6qxxDph1R3hmZ9MeQ/sI/kDFp3CnN7Vcpm7KBTqueGTyhg1zLKKthu0TLxQB1gNzhH5x2ay+jmsFyK5ZMjk8iuNH4xUbbTACjcJlCjMFXrCvLBY3N7Wco+nuKSo1j7L7PgVekM7DW0SPjGMIyrPjaf3HZm/xnRY/55LOusfvtgUVy0dU6uVT53mPwN9i44aon6mWjqXTMBj7W1E+1jaYOP/4E38JdBWBwNbky75MPosXUAmIJOnRszemduzzldWGXxhgsX3BgXcKB+f7kqlzNviED9YVmSfAfA2v2wzK9ryOKTnWObP0JlB5O6IE2+U6e2OvjndZylHULr37tXydO/Dk6+xucrn6hlsFAuP9Vy+EueMTYf06Fo3/rwmO0Nu+M0FXgMYzg9EYyD7LXc5mRiF/Dvvzph3v7454z33GB68gqixWZGpeHYaq3zVNxOGH9ES6lx3Lf68C67ESr8onh+brY2oRJgxbuYZeNiRHozFh/qtOXLoLBQ8e6PoNHMhNV4dRnGhOxoqF392p011dx41P4FZ1u5XZH4e8icdzdOofxGxMdAcD41+Mnni0HmXe3f3RtCpR15QPiKc3TgynPmIO61L+V3+tywmHuouy3Yshz8nE+6jTjks62i7XZ06p0vnXc29rzCdZj76TPmQfBqeS4+laueqjZwa0+ZKLDAFIyoi09pVbGKX6YHI+Duq6E48EAkPnXXXcoToNNyorF6q1Tzu2zDI2MGj8nPz6LMansEpfP6Mrm9QLqOVgQidV7OJL7JG+KzgIbJOuUweOu/yjhsQorPL+XusHTXL0rYlrtmrT4Eenzw6vxBjCVWvlR1+5338COp0PoLlCzzTr2cT30kJxMZeIfMNafEX7KUz4zATpHPEpSnzyYTRuOfTteaf7pZPTdWiU6/es97Vz/OQL8Xo0yBO7SFGTV2IxwJoYaurouNdfLrOd2MOM0E6uXUpPLpZ6y/mFD/6PFa09Nn/+jHyTn2UF6rXsBYNFTJCKxinsNKv1gAPcJ2PJdgkUyVHtoCNOmyVQoa3Su9TX+knlL2PzsId2xug0+aX9OCRRJNzMvRJ4FeBEU+/zEWddMsoZ2rh4ebJWXuKx4zctZEL8lLdWKPRyDKxRn381C3LGoG2z6l4y9IxBbX5CG9pn4EQqlrKE0OgoyOyy3Em1kenYzoCdHJV51eFXEn6JqtJFVXh84leTqSXXqAnra5oD9UT0dPPQMwF6fXeF3mQs/Ek8ryeY3NNzz0wkbBq3Fc2fPH943DHx/xzup1+xS0f+em8e6AnCNC5YtdU9/kI5SiSj3XWcl5nlIXPqT3Q4+5sZiRuH2h2yywFf8gF+QQ6NR2PspXHd2er4DkPM/g/2IcyebKFaXjyiGfu0+XPRu9ThGKc+QCddTp0ATq5HS75BsV2ZrtH9B/YsJgjTlV4obpL7xDrVaYZcjde27LKRnnHhNCoBNJIQOdTLW9SOrvDPBbHPNZy73mIzu8wneV8Hrf5cD2U4dTb+3GEym8x4unQyQYxT2j30+ny5qfGCbtd3cejnRK+MEZVWHHXnMOYEs0Ena3roC20rsfh3fpDIqCzksEnp3RWc4zOZa22ZHQOH7pehy8Y+mlPZWREO0uczvqSiiCNC/108k9Bu8JP6GGMRTugDaeUqoDhR66SeMCalgnz8JsqgssA3ubWc7tln3GPo1OfTnVKpzmdHjx05oOZBxXZi8/oAIXT+WDt6OEkq+Gn01GSn4HLDqlUHmCCAdLiqKowAwR3nQv2cAtAUkXzmkDdy2ccnRRAJwWnsxYmbjU1NtGndug0LXpOYlj8dHLD/hiYkzzJVndUC29JtAKnKuClc6+LmFDWRVz09DOYlZFd8e3xyueFdNYj3Y6pjSKzZS6d3CiX1Dg6gyruyOl01q/vqTXMkKQbsziFjP+oOestD5RzXRsTPf0Q9nIbcAxVV39epjtDA50d4P/M7XYTqTw9dHJPq2ScSec0SCcPMKml5lQFvHTmHzOnoRYckV/C1E2w+ul0LPsyl+OWPQeXQ+nMB1lLT/B/FSyddlTw4aGTyw12YGLoDKQvHenkkSSPdpjnxMj1e+k8wGT2i7u0pWv5+g477od46MT3Yx/K5EohOq47dFY5nblgPmGiyMS90XeLKPH00sndwLz9Q93Jop3HN3YHTJn7/Kupn3Ju5m67xhEVVfMcA6PTRHbtgVlJLEfY74yg04m6ObJySuzhvxU92pP30anTqVfdmT+y7NyW81CVZz59axwsccr74r5Axm87fg59YVJXKQiuiXDMbj895sqWVirUy9bIGm1rOECzpvX61LLvapY1r0Obt0IoW4YMRUgJLdhS0W4e4Y746OSRQM7JUfj9zsCM5GEY9zuZ7XHS+gZTjF6dqzPK69z9YG7T7dY4bHW3ibS6OuezVnuEDBK+q0KO5ZYKtVqd5JIKd2SrClvh8KKRTqVS8gyrrCVaoQh976eT5zV5nBuMivy37MSeTCnzNG2mS7Fgn71UcYnO7Fijt4JfpG+BYPErw+LSpeGgHepJmM1UugmlBGhnR6Qj/HS667VeOkO8UVgBlsvO1VYZ+Oe6u1TtOCwZ1oYHuY+fP2bPC/PYrezi8tGfly0OBzNdsyKwmRJSeHu7maOIh2UCdBoPUXQ6GSXfdR4CGaVK7MW6ztshXkBus8Zh7ejS2GujE/7SvmxBM6B/jLRA6EzJA7YnPNsDdDpOto9OhzifR/7GVCcz7Keu1fHS3+Llo+5L2/wcU+JXvEjS+DX0XfkSPoO+8D5N2UyJbfzJfF+twuYzSCdPBPnodBYevekhjatKlo2fnyhO456pdWLdplC/ikUXI7joiZISwGYEsLmggi5gKZoSYzOV7sPt4skUjL0i6NS9637cfeE2+67kdsB550ovuBrgA/MJlqfu5uEGrqe1WszJ4wItPDGFYpjPu+BaRywCy1xtmbOZEpTY84fo9C3scjodqSrcMefVDq5kOstpmZIHzjDQRl/8ZnKeNk64EpOluRDaI/YRDHrzYfkcnb2u6U/uMjPElKcNNm+124XChTCd3hM6zrVj8QvDhe5bZ8+wEGjquKqa7kBz/SJoY3LJL+keOOo6InF/MfQNcbhmdGYKUkh/zv3GNhZ+s/sqCR46pSxUz5oaCq3Thul0SxS8sUrGmSRVfxVInokrLxPxl3k5EQBRRDzIz/jLvJzs9PVrHJtC2YQzvTBFJwihIdqdpz4fvAcaXjKZLUL2Owol7yLoNFzt6dIZN0l4qppHO0EFzvsiRoyLYYA3rpl5rH8VLH2Kr2CtcLPRCrU4S316C+CoJvYAHHk0r0zDz8NF0IneHWfJE0lr0RV0XHs4szoQlzkFD5+esrmAQ+fuv3qNw1qtiL81UZxbbwTbnKM+/aUU43TKTyeY9sgMbRSd7vj56jvroVmSGfKZ7UQ79UCs6IRK2EvfxUihe/DVaxyQcoMZ2HAJEPvBRmd4n77i4bHiZzMl7PHehRqRZYik03GW/NXHm2D18ZPToRPtBFeGXKq2yPFeg+E5z+SF8mGXwoLJAjZk7JmdUjPYbBpYKw4h410vDMpmiieVjotQnuHzgZao532y+1Zj1e3+qTvaDEv1TAEjE6iNv2fdlEKLPh+sq1Jd5eXwoQz3wfnm2vIaSHCDnfMpO2kdbPadOfJcoRGSTTBw8I2mb1dBQ6eXKfwPYlgHtjvoWRv6tPJVyHw9Hf1lOiprXw7xYfJvygdnI9jGcL66dsloVNlBDSZK+WyH3Au2C9faeFFylY7RCskmKBD8jf6x/M88aeSnMyWH5PPzBJ9VV7cP0kIEm4ROEODDr5Sm/jUwdptNF3RnwLMJ82nE81nIOVLXkSPZTEGUqeMZubhpucXfB67LWkECpEmw6Vuc/nQVeFOO4pJlPEempi3+5dOdJ/n2IakS98G2u2j7PuTm2h5LUVwCxqzJv/31VW/H1Qosez9sQNKpQaDxNMqfr/EReZGiJzpIJ4QG87I2CrGZBQycTZqBGbDNrB+vvoO82z7wA3nzGe840G6AXr0fbgIeRDcj7LFQDBp4vRbKZvPaw9d9rGjikQHNMdJ0NZTxnsiiKFO9UpREiWby+nhnsYmMZ9GLImewU8Sfnlnuy98Gmk3oTqc56Q1OIUi+dmuULfIPkiQ3wsnJywGRNsTsvbCziCHtAwkm++nBFzoXaME2MprFWNHEUMCw6atNOEH7IuJhI6pgAMMhk/OBXRQ7PGnoXIzDDwy9wnR7SFtDfkAONidJA7+5xdeU9UpAWg5Fgz+BSgqtO2IkD0LIwperbvF8gT8evJYiR8Nl4gXynXjwQvlOSiJsteEKROCA0IiJpXQKHDLjh7Es0U9F+mXKaSqeptPpTuR0OseHo+uLoVVGS+e2oqAo7RD/w1w1k6nWH6pENLP956IEiJdPaUbfGBBO0CE4rwSaiyRhiBhD7hUS+IQ3YdxgGLPZ2KYjL76QT/RrGiOTzf36FJ1ud/s2pVOADynSJx+wn2O0Pd7PwRmMcXHw6URlHQgNR/Pux9NqS/2jl2az18kOBoNOOFbnKOIO9LnzBhwvGnRic9kBdwIUAOSgCJ1SSKWx9ILgzXwRnZFyPsbTSTOvDFlnatB8b/om090ykT8HEiRUkfsRq8ZhNOL6oBmQyibiYWdItIJM8tUVRM2i0oujcwB7QZKLHr3evpZOqpDDud7LYc4rKNq0u0iLcqN90vS9zrIvcX0ocDOL6GeLsiJNsTKzAOzBqAAZ0XRS/hnjHNfTGejhp1h09e2B3dZJpEVJHk96L9nZwG/ujey6n5Il7IXEjQiZzHjYdhFFSq8yVZRsOQBuF64Eqhij6cRmQ0iDyhU8shRFJz/wAjrH6Hoc6NNuxRguvBDSiiQ9e8sbXnv7oqRE5z0ckApPo7zYRuW/FIGsdLL8NVZfhGCgitCZXrcpmLoBO4WdJODIs+waQWe6SY97AWF36ExPWHftAJ2kVSiwvhzluTV/RycUn19G5bHH/GUbRfH7w8igH+sxqVkgBksSiOQeBoxO/wmnE88K6mgzywMOAJ7HHYlxFEsnP5BcoOso8e5kTidxuGxSY3G9ZUdGfqGO+BV9x6VY7HvmXqclnVS4HKReFmnb1SJqIRsCCLENIikBkbJBdzh08jFpuExJdDIJ4kk6fVcecuMVTmcKfDwZbiQdylJcw+vp2S4oOA578fDx0joRVfogc+UQWRZAZm8T3xmmQwZHnokrp1OhYNLZYU6UY6/i6RTYkQHppDtFRzrdUR/f9MW4jVOiJuzXWe/Zsq0TXnvw0JOnJcO4x6YaT3DMUboHLhtRaIROpdkjWLfpRQKLHUag6ydG0Cn0JxRjn+7ss+4gXvDRqYRWIK5D9oS0BUKj8yUzxe16PIjQ4HvGExybd2EscBMbYdlt6gLNZrMOt/8EV1j2lCSTnLd4veL0I3VC3iQ34TJrit+rWRfYuJwGiS4FEmrC/TlzM4rOHjkzaDuy4ZBzhd8pvRoGGcJb+PDha41BWm41e+1esyF/k+4IQgwtOwXAbaDoGh8ynaPoDCwaOI7ilW58lhzwcg15EVBOqkOs2sXvPMwISN8peJZ9IdUnLNSl5cphOgfeHJPb8PqoiIjn9TGRHyfF84f4VjhpUomZAham0uQboVPMGhz86zEFOYj1fjadSs9w+3PpJOLpo/pKGJBWEi6Wve9AfMNv3uRJ16mIGNK0K/Mx6dQXZYbnLJk+nEHCLVfMZ9OZUpzuet6oiIjnd1r+fLyT4oXOBQb7PEht3O3GOMknlTlipV+pq0kZC2bjZ9R08NlPSlIZaefT6UD00UnF80a+kv3GIsDwguZ1ILbCVNEOWfEqlIgksyopj88SonOS5vU5BJ4U5dV0UvF0w6yrQKI/CNxfY7PIPwMxFYtD2UQn3uv4+gxzjwbg/SJsU2E2nmUvnjuknZumgLbFZzJMbfxVUXa+eaa6wW1Gjkr7u1ujLGlHW9Ht7xX9OSjrSH0i6Z7eTac7s0P6HXnTzX8HyxW/3f1ZWY3zQCawBc/Uqb/40tG/FSMoeTXOyLidy6bEV9t++10Gfx3KI2TvNKgqmN1MfdLCAXiuVf13F85FAX7miTzS274Rn7RI1DBX4Cn92Xv7/8PYoiP7+Zf1TcwRLQnf7UxrtfsP/oDRUd9xZ3tyAz5pSUXXQF8n3y2cbQLacObZBDZ7LNfc7u/7LCdhrBtsm7RYcz++3aRO0yveTfTKgG+Qvc3GfkKarpsU7AxNvHfSXLM2DdImy5rcMEnneYX29XxSNu0ndLT0U4aoJ6d5OVeWbQJxRktSREVixUuKiLchCS2l8aYos3UOUaHaeVBM01w97kxus46zRTiKFK21ROhYUlDHOZkktnxt+GXcxu+koAvhxGOKq3s9F7TYdmmi+2/ee91ThEa/LwnFV5QVhX2/IZJyhL6iNHp7RaTBjDjp7dNSD1JerX5fEOijEDjIpHlRSEkRF74hOGkMQxLE5logD+2OBaEPwOEXnKzfn+GOxqRNet1rCcUBjqroN7fM0RE2pwtSs9Q7Z504FnSU5wdkosVpPnsKxOAvotLEdELZUU/BjLzKLF0nQ9qHkKakx8hhgWR614pAkxZAJ4nkZTcr1BNhEWAgQxA6Flh5WEeU2MoA6Qi3ycLTo7j/thgu3rkFpipSSfyejalyPwcyuWjrifyo1mkfidKJgD5MZ5tM7TV6kUS6HoQD7zVtMRlzOjE9JLZupRtp8hWmU4CsyUxypbORZnlM0U8nEz/SUZ+2eS6O6ZluD3jToUafu3ltXZZ1d6DQquW5qd3rKPwQjx8hOmeS0uMUkj1NxVkJZXS2SLJjIEszwiKmU+jDou5a7AucTrZWgRkzYqWT7bdt+7ek811Hxj3q0rrByU8EVOBVp+q9rR21714iTulss8neRnYD1B2mE4YkK4k9YMRJ7wELRlskRQ09RcbfAWlYoHsipm0vEk1BINIM1QTGAuvOyWSCNSboTrzVZHS23ARnW4QVYyn0OOq1UFcrPEVt+lsr2fTFAqqkyaSxTUihIu3b15VgU9RqpURqiiC3K4BPEKJzXySpH3w5sizSh+7HWKBfREhZDbBq2OPJWpRmUjSdKbDaHcgEYgMujSPpVKCg+9Z0YujHLoJfEgY0ixdlRNJFmmazzdwRbY0z3oHbU1IKODEzUnSWxloQhJvROfPQKYDxVlKClE4RNl9lpY2tEiyJYDrbPXk9kxuDGDqFJhZKKp14ax1Fp9KbzbK/MOGNL2SskF6h0/S1fz6haXw/tI+SVlanXf2M0LKnpNcvL+Q2smJ6PVBIerjn1Z1pTJ9tNASZsDCYpEl2Gbs24/2eJK1gsg/kfU9uu9LZOl93zmaz3zJFAHODOf2A3xwlGJxJqFJkS/E2vIMKu+/mOY/fMuIAxFFqpsGmd4jPBF9mmTuDOJ3YBJGlpIYAD2IoULGD6WyCSyq/UmsGYJa9BbWOJyw7DPiz/GuWncDaot1ybi74gsRrU4ot3WQQRKnJH82pHpGuRb5wLgJ+OttAFriWRWrCYUlzUCRVOXtOJ2wNoMW+1+tNwPYMwHOcKNjeu3Ti2bsG5QsPeMTR+UJkOQstf8vvpNDLyJwj/d5Job80ZDFuiV1IQzEYa7jdHazFYjQ/N/sepBOkcAbvYBKEhiJAJIT6+Mz9Vjr1zFjoiJijjsiK7LCoEjo7YrrpoRNhozNukGgrlk7sTYl72gabIli6Dz95fjts9bmNls7rITqTtBwsW4DyWVnpu4V1Gwu9l5ej5dkvKekVPU9fFdsQRxNPa1JkT1xh4KEUJSk1gye5QCNK0jPqy89kNrSkZ2PwTJ7pwh1lSRcEry14KItM4ZZUpPteikVGJ+3olTy4BVWdvSKcQrppzO7H7jD9QPZitHIzI6+ddSNVlKFCCE4uF1ONdcfxsW0cA0HC9AM9RZceRmHQcTp47XSAoU6HmItBb93j6mOGt4kMdzpAzwwfw1qRbaPTAceg43RBke2t6ThnWVv4mp2MdoT/rmkbfBkEN3qWMAI2vIZhOkfWUj36f5xhQJ9yDJTI2zv7QN7vvUE2ShCGPUUrc7UxUHnatU4+iA4DfADOzZV9uOF7Rf9lKJtohNnBMnc8YsKiGx26XWBSU+HJNmuZ/DL7KXRt8mNG3S0qV9HnolvGcmoYljUCCu1Kd4f4y3me7FO1CQkIsB6cWsh+3xrTI3lF0PsT0nX1eASTX4GnENVjl5h/Y9FNlOYZwHKomsuFeRh94Dm/VbWyxn6iAwz5ykqU5aXQ0MZc2uQ9Mwu0wn/pr93CPF8lU/xH0NF8M9exH6R/2izHbG70roUS4/NTWDrYdyyOIxpEGgmVCRIkSJAgQYIECRIkSJAgQYIECRIkSJAgQYIE/wT8D4usqJcF3f+4AAAAAElFTkSuQmCC" alt="WPO logo" class="logo">
        <h1>System for Public Access to Research Knowledge (SPARK)</h1>
      </div>
      <div class="title-underline"></div>

    <div class="top-row">
       <!-- Column 1: Intro Text -->
      <div class="top-col intro-text">
        <p>
          The SPARK tool is designed to increase access to and visibility of research projects funded by the Weather Program Office (WPO). By providing public access to project-level information, including topics, hazards, and related research outputs, SPARK supports WPO’s open science initiative, helping users discover, understand, and apply research knowledge across the Weather Enterprise.
          <br><br>
          <strong>Start exploring WPO-funded projects now—search by hazard, topic, or keywords and discover related publications and research outputs using the filters below.</strong>
        </p>
      </div>
  <!-- Column 2: Output Widget -->
      <div class="output-widget">
        <div class="widget-title">Total<br>Projects</div>
        <div class="output-number-box">
          <div id="output-count" class="output-number"></div>
        </div>
      </div>
<!-- Column 3: Contact + Feedback Widgets -->
      <div class="top-col contact-feedback">
        <div class="widget contact-widget">
          <h3 class="widget-header"><strong>Contact Information:</strong></h3>
          <p>PART Program<br>
          <a href="mailto:part.wpo@noaa.gov" style="text-decoration: underline;">part.wpo@noaa.gov</a></p>
        </div>
        <div class="widget feedback-widget">
          <div class="widget-content">
            <h3 class="widget-header"><strong>Have feedback for us?</strong></h3>
            <p>
              Submit your feedback through our<br>
              <a href="https://forms.gle/RV3HyXy9s8B2cEfY8" target="_blank" style="text-decoration: underline;">Google Form</a>!
            </p>
          </div>
        </div>
      </div>
    </div>

 <div class="hazard-nav">
  <div class="hazard-button-wrapper">
  <button class="hazard-button all" data-hazard="ALL">
    <img src="https://raw.githubusercontent.com/PART-WPO/SPARK/refs/heads/main/all-hazards.png" alt="All" />
  </button>
  <div class="hazard-label">RELEVANT TO ALL</div>
</div>
   <div class="hazard-button-wrapper">
  <button class="hazard-button severe" data-hazard="SEVERE">
    <img src="https://raw.githubusercontent.com/PART-WPO/SPARK/refs/heads/main/severe%20(1).png" alt="Severe" />
  </button>
  <div class="hazard-label">SEVERE</div>
</div>
   <div class="hazard-button-wrapper">
  <button class="hazard-button temps" data-hazard="EXTREME TEMPS">
    <img src="https://raw.githubusercontent.com/PART-WPO/SPARK/refs/heads/main/extremetemp.png" alt="Extreme Temps" />
  </button>
  <div class="hazard-label">EXTREME TEMPS</div>
</div>
     <div class="hazard-button-wrapper">
  <button class="hazard-button water" data-hazard="WATER">
    <img src="https://raw.githubusercontent.com/PART-WPO/SPARK/refs/heads/main/flooding.png" alt="Water" />
  </button>
  <div class="hazard-label">WATER</div>
</div>
  <div class="hazard-button-wrapper">
  <button class="hazard-button fire" data-hazard="FIRE">
    <img src="https://raw.githubusercontent.com/PART-WPO/SPARK/refs/heads/main/fire%20weather.png" alt="Fire" />
  </button>
  <div class="hazard-label">FIRE</div>
</div>
  <div class="hazard-button-wrapper">
  <button class="hazard-button tropical" data-hazard="TROPICAL">
    <img src="https://raw.githubusercontent.com/PART-WPO/SPARK/refs/heads/main/tropical%20(1).png" alt="Tropical" />
  </button>
  <div class="hazard-label">TROPICAL</div>
</div>
     <div class="hazard-button-wrapper">
  <button class="hazard-button winter" data-hazard="WINTER">
    <img src="https://raw.githubusercontent.com/PART-WPO/SPARK/refs/heads/main/winter%20(2).png" alt="Winter" />
  </button>
  <div class="hazard-label">WINTER</div>
</div>
  <div class="hazard-button-wrapper">
  <button class="hazard-button air-quality" data-hazard="AIR QUALITY">
    <img src="https://raw.githubusercontent.com/PART-WPO/SPARK/refs/heads/main/air%20quality%20(2).png" alt="Air Quality" />
  </button>
  <div class="hazard-label">AIR QUALITY</div>
</div>
</div>
      
      
   <!-- Search & Filter Section with Light Blue Background -->
<div class="filters-container">

  <!-- Top Search Row -->
  <div class="filter-row">
  <!-- Left: Search + Dropdown -->
  <div class="filter-inputs">
    <div class="filter-group">
      <label for="combinedSearch">Search</label>
      <input type="text" id="combinedSearch" placeholder="Search by Keyword" />
    </div>

  <div class="filter-group">
     <label for="programFilter">Funded By</label>
      <select id="programFilter">
      <option value="">All Programs</option>
      <option value="EPIC">EPIC</option>
      <option value="JTTI">JTTI</option>
      <option value="Observations">Observations</option>
      <option value="Social Science">Social Science</option>
      <option value="S2S">S2S</option>
      <option value="Synoptic">Synoptic</option>
      <option value="Testbeds">Testbeds</option>
      <option value="VORTEX">VORTEX</option>
    </select>
    </div>
  </div>
    
 <!-- Right: Buttons -->
  <div class="filter-buttons">
    <button id= "toggleFilters" class="filter-toggle">
      <span class="material-icons">tune</span> Filters
    </button>
    <button id='reset-btn' class="reset-btn" onclick="resetFilters()">
      <span class="material-icons">refresh</span> Reset
    </button>
  </div>
</div>

  <!-- Hidden Popout Filters -->
  <div class="filters-popout" id="filtersPopout">
    <!--Row 1--->
    <div class ="filter-row two-columns">
    <div class="filter-group">
      <div class="my-choices-wrapper">
  <label for="keywordFilter">Filter By Keywords</label>
  <select id="keywordFilter" multiple>
  <optgroup label="Physical Science Topics">
    <option value="Aircraft Reconnaissance">Aircraft Reconnaissance</option>
    <option value="Artificial Intelligence (AI) / Machine Learning (ML)">AI/ML</option>
    <option value="Atmospheric Composition and Chemistry">Atmospheric Composition and Chemistry</option>
    <option value="Atmospheric Physics">Atmospheric Physics</option>
    <option value="Aviation">Aviation</option>
    <option value="Compound Hazards">Compound Hazards</option>
    <option value="Coupled Models & Techniques">Coupled Models & Techniques</option>
    <option value="Data Assimilation and Ensembles">Data Assimilation and Ensembles</option>
    <option value="Decision Support">Decision Support</option>
    <option value="Dynamics and Nesting">Dynamics and Nesting</option>
    <option value="Earth Prediction Innovation Center (EPIC)">Earth Prediction Innovation Center (EPIC)</option>
    <option value="Forecast Skill Metrics">Forecast Skill Metrics</option>
    <option value="High-Performance Computing (HPC)">High-Performance Computing (HPC)</option>
    <option value="Reanalysis & Reforecasting">Reanalysis & Reforecasting</option>
    <option value="In-situ Observation Technologies and Sensors">In-situ Observation Technologies and Sensors</option>
    <option value="Model & Forecast Guidance">Model & Forecast Guidance</option>
    <option value="Numerical Weather Prediction (NWP)">Numerical Weather Prediction (NWP)</option>
    <option value="Observing System Simulation Experiments (OSSEs)">Observing System Simulation Experiments (OSSEs)</option>
    <option value="Parameterization">Parameterization</option>
    <option value="Post-processing">Post-processing</option>
    <option value="Preprocessing">Preprocessing</option>
    <option value="Precipitation Grand Challenge">Precipitation Grand Challenge</option>
    <option value="Probabilistic Weather Forecasting">Probabilistic Weather Forecasting</option>
    <option value="Radar">Radar</option>
<option value="Radiosonde Observations">Radiosonde Observations</option>
    <option value="Satellite & Remote Sensing Technologies">Satellite & Remote Sensing Technologies</option>
    <option value="Stepped Frequency Microwave Radiometer (SFMR)">Stepped Frequency Microwave Radiometer (SFMR)</option>
    <option value="Structural Engineering">Structural Engineering</option>
    <option value="Surface Observing Networks">Surface Observing Networks</option>
    <option value="Teleconnections">Teleconnections</option>
    <option value="Uncrewed Systems & Vehicles">Uncrewed Systems & Vehicles</option>
    <option value="Verification & Validation">Verification & Validation</option>
    <option value="Water in the West">Water in the West</option>
    <option value="Weather Buoy Systems">Weather Buoy Systems</option>
    <option value="Visualizations">Visualizations</option>
  </optgroup>
  <optgroup label="Social Science Topics">
    <option value="Communicating Probabilities & Uncertainty">Communicating Probabilities & Uncertainty</option>
    <option value="Community Preparedness & Resilience">Community Preparedness & Resilience</option>
    <option value="Flow of Weather Risk Information">Flow of Weather Risk Information</option>
    <option value="Forecast Product Usability & Design">Forecast Product Usability & Design</option>
    <option value="Decision-Making">Decision-Making</option>
    <option value="Economic Valuation">Economic Valuation</option>
    <option value="Information Seeking & Processing">Information Seeking & Processing</option>
    <option value="Integrated Warning Team (IWT)">Integrated Warning Team (IWT)</option>
    <option value="Language & Cultural Contexts">Language & Cultural Contexts</option>
    <option value="Organizational Dimensions">Organizational Dimensions</option>
    <option value="Personalization of Weather Information">Personalization of Weather Information</option>
    <option value="Physical-Social Data Linkages">Physical-Social Data Linkages</option>
    <option value="Risk Categories, Indices, or Levels">Risk Categories, Indices, or Levels</option>
    <option value="Risk Communication">Risk Communication</option>
    <option value="Risk Perception & Response">Risk Perception & Response</option>
    <option value="Social Vulnerability">Social Vulnerability</option>
    <option value="Societal Impacts & Outcomes">Societal Impacts & Outcomes</option>
    <option value="Social, Behavioral, and Economic Sciences (SBES)">Social, Behavioral, and Economic Sciences (SBES)</option>
    <option value="Visual Risk Communication">Visual Risk Communication</option>
  </optgroup>
  <optgroup label="Social Science Methods">
    <option value="Interviews">Interviews</option>
    <option value="Surveys">Surveys</option>
    <option value="Focus Groups">Focus Groups</option>
    <option value="Delphi Group Method">Delphi Group Method</option>
    <option value="Experiments">Experiments</option>
    <option value="User-Centered Design">User-Centered Design</option>
    <option value="Social Media Analysis">Social Media Analysis</option>
    <option value="Economic Modeling">Economic Modeling</option>
    <option value="Literature Review">Literature Review</option>
    <option value="Document Analysis">Document Analysis</option>
    <option value="Ethnographic Observation">Ethnographic Observation</option>
  </optgroup>
    <optgroup label="Audience Sample">
    <option value="Forecasters">Forecasters</option>
    <option value="Emergency Managers">Emergency Managers</option>
    <option value="Experts">Experts</option>
    <option value="Other Core Partners">Other Core Partners</option>
    <option value="Broadcast Meteorologists">Broadcast Meteorologists</option>
    <option value="Public">Public</option>
    <option value="Vulnerable Populations">Vulnerable Populations</option>
    <option value="Business Sector">Business Sector</option>
  </optgroup>
</select>
</div>
      </div>

    <div class="filter-group">
      <div class="my-choices-wrapper">
  <label for="modelFilter">Forecast Systems and Models</label>
  <select id="modelFilter" multiple>
    <option value="ADvanced CIRCulation (ADCIRC)">ADvanced CIRCulation (ADCIRC)
</option>
    <option value="Advanced Hydrologic Prediction Service (AHPS)/National Water Prediction Service (NWPS)
">Advanced Hydrologic Prediction Service (AHPS)/National Water Prediction Service (NWPS)
</option>
    <option value="Advanced Weather Interactive Processing System (AWIPS)">Advanced Weather Interactive Processing System (AWIPS)

</option>
    <option value="Anemoi Framework">Anemoi Framework
</option>
    <option value="Climate Forecast System (CFS)">Climate Forecast System (CFS)
</option>
    <option value="Colorado River Decision Support System (CRDSS)">Colorado River Decision Support System (CRDSS)
</option>
    <option value="Common Community Physics Package (CCPP)">Common Community Physics Package (CCPP)
</option>
    <option value="Community Atmosphere Model (CAM)">Community Atmosphere Model (CAM)
</option>
    <option value="Community Earth System Model (CESM)">Community Earth System Model (CESM)
</option>
    <option value="Community Fire Behavior Model (CFBM)">Community Fire Behavior Model (CFBM)
</option>
    <option value="Community Hydrologic Prediction System (CHPS)
">Community Hydrologic Prediction System (CHPS)
</option>
    <option value="Community Ice CodE (CICE)">Community Ice CodE (CICE)
</option>
    <option value="Community Mediator for Earth Prediction Systems (CMEPS)">Community Mediator for Earth Prediction Systems (CMEPS)
</option>
    <option value="Community Multiscale Air Quality (CMAQ) Model">Community Multiscale Air Quality (CMAQ) Model
</option>
    <option value="Community Radiative Transfer Model (CRTM)">Community Radiative Transfer Model (CRTM)
</option>
    <option value="Convection Allowing Models (CAM)">Convection Allowing Models (CAM)
</option>
    <option value="Coupled Forecast System (CFSv2)">Coupled Forecast System (CFSv2)
</option>
    <option value="Earth System Modeling Framework (ESMF)">Earth System Modeling Framework (ESMF)
</option>
    <option value="Ensemble Prediction Systems (EPS)">Ensemble Prediction Systems (EPS)
</option>
    <option value="EMC Verification System (EVS)">EMC Verification System (EVS)
</option>
    <option value="Finite-Volume Cubed-Sphere Dynamical Core (FV3)">Finite-Volume Cubed-Sphere Dynamical Core (FV3)
</option>
    <option value="Global Data Assimilation System (GDAS)">Global Data Assimilation System (GDAS)
</option>
    <option value="Global Ensemble Forecast System (GEFS)
">Global Ensemble Forecast System (GEFS)
</option>
    <option value="Global Extratropical Surge and Tide Operational Forecast System (G-ESTOFS)">Global Extratropical Surge and Tide Operational Forecast System (G-ESTOFS)
</option>
    <option value="Global Extratropical Surge and Tide Operational Forecast System (G-ESTOFS)">Global Extratropical Surge and Tide Operational Forecast System (G-ESTOFS)
</option>
    <option value="Global Forecast System (GFS)">Global Forecast System (GFS)
</option>
    <option value="Global Spectral Model (GSM)">Global Spectral Model (GSM)
</option>
    <option value="Gridpoint Statistical Interpolation (GSI)">Gridpoint Statistical Interpolation (GSI)
</option>
    <option value="High Resolution Ensemble Forecast (HREF)
">High Resolution Ensemble Forecast (HREF)
</option>
    <option value="Community Multiscale Air Quality (CMAQ) Model">Community Multiscale Air Quality (CMAQ) Model
</option>
    <option value="High-Resolution Rapid Refresh (HRRR)">High-Resolution Rapid Refresh (HRRR)
</option>
    <option value="High-Resolution Rapid Refresh-Smoke (HRRR-S)">High-Resolution Rapid Refresh-Smoke (HRRR-S)
</option>
    <option value="Hurricane Analysis and Forecast System (HAFS)">Hurricane Analysis and Forecast System (HAFS)
</option>
    <option value="Hurricane Weather Research and Forecasting (HWRF)">Hurricane Weather Research and Forecasting (HWRF)
</option>
    <option value="Hurricanes in a Multi-scale Ocean-coupled Non-hydrostatic (HMON)">Hurricanes in a Multi-scale Ocean-coupled Non-hydrostatic (HMON)
</option>
    <option value="HYbrid Coordinates Ocean Model (HYCOM)">HYbrid Coordinates Ocean Model (HYCOM)
</option>
    <option value="Local Climate Analysis Tool (LCAT)">Local Climate Analysis Tool (LCAT)
</option>
    <option value="Model Evaluation Tools Plus (METPlus)
">Model Evaluation Tools Plus (METPlus)
</option>
    <option value="Modular Ocean Model (MOM)">Modular Ocean Model (MOM)
</option>
    <option value="Model for Prediction Across Scales (MPAS)">Model for Prediction Across Scales (MPAS)
</option>
    <option value="Multi-Radar/Multi-Sensor System (MRMS)">Multi-Radar/Multi-Sensor System (MRMS)
</option>
    <option value="National Blend of Models (NBM)">National Blend of Models (NBM)
</option>
    <option value="National Integrated Drought Information System (NIDIS)
">National Integrated Drought Information System (NIDIS)
</option>
    <option value="National Fire Danger Rating System (NFDRS)">National Fire Danger Rating System (NFDRS)
</option>
    <option value="National Mesonet Program (NMP)">National Mesonet Program (NMP)
</option>
    <option value="National Water Model (NWM)">National Water Model (NWM)
</option>
    <option value="National Unified Operational Prediction Capability (NUOPC)">National Unified Operational Prediction Capability (NUOPC)
</option>
    <option value="NDBC Coastal Weather Buoy System (CWB)">NDBC Coastal Weather Buoy System (CWB)
</option>
    <option value="Next Generation Water Resources Modeling Framework (NextGen)">Next Generation Water Resources Modeling Framework (NextGen)
</option>
    <option value="Next Generation Global Prediction System (NGGPS)">Next Generation Global Prediction System (NGGPS)
</option>
    <option value="Noah Multiparameterization Land Surface Model (Noah-MP LSM)">Noah Multiparameterization Land Surface Model (Noah-MP LSM)
</option>
    <option value="North American Mesoscale Model (NAM)">North American Mesoscale Model (NAM)
</option>
    <option value="North American Multi-Model Ensemble (NMME)">North American Multi-Model Ensemble (NMME)
</option>
    <option value="NOAA’s National Air Quality Forecasting Capability (NAQFC)">NOAA’s National Air Quality Forecasting Capability (NAQFC)
</option>
    <option value="Rapid Radiative Transfer Model for GCMs (RRTMG)
">Rapid Radiative Transfer Model for GCMs (RRTMG)
</option>
    <option value="Rapid Refresh (RAP)">Rapid Refresh (RAP)
</option>
    <option value="Radar Next">Radar Next
</option>
    <option value="Real Time Ocean Forecast System (RTOFS)">Real Time Ocean Forecast System (RTOFS)
</option>
    <option value="Real-Time Mesoscale Analysis (RTMA)">Real-Time Mesoscale Analysis (RTMA)
</option>
    <option value="Real-Time Air Quality Modeling System (RAQMS)">Real-Time Air Quality Modeling System (RAQMS)
</option>
    <option value="Seamless System for Prediction and EArth System Research (SPEAR)">Seamless System for Prediction and EArth System Research (SPEAR)
</option>
    <option value="Seasonal Forecast System (SFS)">Seasonal Forecast System (SFS)
</option>
    <option value="Semi-implicit Cross-scale Hydroscience Integrated System Model (SCHISM)">Semi-implicit Cross-scale Hydroscience Integrated System Model (SCHISM)
</option>
    <option value="Short-Range Ensemble Forecast (SREF)">Short-Range Ensemble Forecast (SREF)
</option>
    <option value="Unified Forecast System (UFS)">Unified Forecast System (UFS)
</option>
    <option value="UFS Air Quality Model (UFS-AQM)">UFS Air Quality Model (UFS-AQM)
</option>
    <option value="UFS-Medium Range Weather Application (MRWA)">UFS-Medium Range Weather Application (MRWA)
</option>
    <option value="UFS-Short-Range Weather Application (SRWA)">UFS-Short-Range Weather Application (SRWA)
</option>
    <option value="UFS-Season to Subseasonal (UFS-S2S)">UFS-Season to Subseasonal (UFS-S2S)
</option>
    <option value="UFS-Coastal Applications (UFS-Coastal)">UFS-Coastal Applications (UFS-Coastal)
</option>
    <option value="Unified Post Processor (UPP)">Unified Post Processor (UPP)
</option>
    <option value="WaveWatch III">WaveWatch III
</option>
    <option value="Warn on Forecast System (WoFS)">Warn on Forecast System (WoFS)
</option>
    <option value="Weather Research and Forecasting Model (WRF)">Weather Research and Forecasting Model (WRF)
</option>
    <option value="Weather Research and Forecasting Model - Fire (WRF-Fire)">Weather Research and Forecasting Model - Fire (WRF-Fire)
</option>
    <option value="Weather Research and Forecasting Model - Hydro (WRF-Hydro)">Weather Research and Forecasting Model - Hydro (WRF-Hydro)
</option>
    <option value="Whole Atmosphere Community Climate Model (WACCM)">Whole Atmosphere Community Climate Model (WACCM)
</option>
        </select>
    </div>
      </div>
    </div>
         <!--Row 3--->
      <div class="filter-row three-columns second-row">
    <div class="filter-group">
      <label for="projectStatus">Project Status</label>
      <select id="projectStatus">
        <option value="">Show All</option>
        <option value="Complete">Complete</option>
        <option value="Active">Active</option>
      </select>
    </div>

    <div class="filter-group">
       <label for="yearFilter">Year Funded</label>
  <select id="yearFilter">
    <option value="">All Years</option>
    <!-- Year options will be added dynamically -->
  </select>
</div>
        <div class="filter-group">
      <label for="projectState">State</label>
      <select id="projectState">
        <option value="">Show All</option>
      </select>
    </div>
      </div>
      </div>
    </div>
<p id="noResultsMessage" class="no-results">
  <span class="no-results-title">No results found.</span>
  <br>
  Nothing is turning up with that word, phrase, or award number. Please check your filters or try something else.
</p>
  <div class="results-container">
    <div class="faux-header">
      <div class="cell hazard-icon"></div>
      <div class="cell title">Title & Project Goal</div>
      <div class="cell pi">PI Last Name(s)</div>
      <div class="cell program">Program</div>
      <div class="cell status">Project Status</div>
      <div class="cell year">Year Funded</div>
      <div class="cell link">Link to Outputs</div>
    </div>
      </div>
    <div id="pagination" class="pagination-controls"></div>
    <p id="pagination-info" class="pagination-info"></p>
  </div>

  <div class="drawer-overlay" id="projectDrawer">
  <div class="drawer-content">
   <div class="drawer-header">
     <div class = "drawer-header-inner">
   <div class="drawer-context-chip" id= "drawer-context-chip"></div>
     <img id="drawerIcon" alt="Hazard Icon" />
  <div class="drawer-header-content">
    <div class="drawer-header-row">
      <div class="drawer-title-group">
        <h2 id="drawerTitle">Project Title</h2>
        <p id="drawerGoal">Project Goal</p>
      </div>
      <div class="drawer-close" onclick="closeDrawer()">✖</div>
    </div>
    <div class="drawer-keywords-row">
  <div class="keywords-left">
    <span class="keyword-label">Keywords:</span>
    <div class="drawer-keywords" id="drawerKeywords"></div>
  </div>
  <a href="#" id= "drawerLink" class="output-button"><span class="material-icons toggle-icon">open_in_new</span>View Outputs</a>
    </div>
    </div>
  </div>
</div>

    <div class="drawer-section collapsible" id="detailsSection">
  <div class="collapsible-header" onclick="toggleCollapse(this)">
    <span class="material-icons">info</span>
    <h3>Project Details</h3>
    <span class="material-icons toggle-icon">expand_more</span>
  </div>
  <div class="collapsible-body">
    <ul class="drawer-details">
      <li><strong>Award Number:</strong> <span id="drawerAward"></span></li>
      <li><strong>WPO Program:</strong> <span id="drawerProgram"></span></li>
      <li><strong>Period of Performance:</strong> <span id="drawerPeriod"></span></li>
      <li><strong>Principal Investigators:</strong> <span id="drawerPIs"></span></li>
      <li><strong>Organizations Involved:</strong> <span id="drawerOrgs"></span></li>
      <li><strong>State(s):</strong> <span id="drawerState"></span></li>
    </ul>
  </div>
</div>
    
    <div class="drawer-section collapsible" id= "descriptionSection">
      <div class="collapsible-header" onclick="toggleCollapse(this)">
        <span class="material-icons">description</span>
        <h3>Project Description</h3>
        <span class="material-icons toggle-icon">expand_more</span>
      </div>
      <div class="collapsible-body collapsed">
        <p id="drawerDescription"></p>
      </div>
    </div>

    <div class="drawer-section collapsible" id= "benefitsSection">
      <div class="collapsible-header" onclick="toggleCollapse(this)">
        <span class="material-icons">insights</span>
        <h3>Project Benefits</h3>
        <span class="material-icons toggle-icon">expand_more</span>
      </div>
      <div class="collapsible-body collapsed">
        <p id="drawerBenefits"></p>
      </div>
    </div>

    <div class="drawer-section collapsible" id="transitionSection">
  <div class="collapsible-header" onclick="toggleCollapse(this)">
    <span class="material-icons">handshake</span>
    <h3>Transition Information</h3>
    <span class="material-icons toggle-icon">expand_more</span>
  </div>
  <div class="collapsible-body">
    <ul class="drawer-bullets">
      <li><strong>Transition Point of Contact:</strong> <span id="drawerPOC"></span></li>
      <li><strong>Operational Partner(s):</strong> <span id="drawerPartner"></span></li>
    </ul>
  </div>
</div>
  </div>
</div>
      
  <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>

<script>
let keywordChoices;
let modelChoices;
let selectedModels = [];
let selectedStatus = "";
  const csvUrl = "https://raw.githubusercontent.com/PART-WPO/SPARK/refs/heads/main/SPARK%20Report%20-%20SPARK%20Report.csv";

const allRows = [];
const itemsPerPage = 10;
let currentPage = 1;
let initialLoad = true;
let selectedRow = null;

// Load and parse the CSV
fetch(csvUrl)
  .then(response => response.text())
  .then(csvText => {
    Papa.parse(csvText, {
      header: true,
      skipEmptyLines: true,
      complete: function (results) {
        populateRows(results.data);
      }
    });
  });

function populateRows(projects) {
  const resultsContainer = document.querySelector('.results-container');

  // Clear previous rows before adding new ones
  resultsContainer.innerHTML = '';
  
  // Sort projects by "Year Funded" in descending order (most recent first)
  projects.sort((a, b) => {
    const yearA = parseInt(a["Year Funded"], 10);
    const yearB = parseInt(b["Year Funded"], 10);

    // If "Year Funded" is not a valid number, default it to 0
    if (isNaN(yearA)) return 1;
    if (isNaN(yearB)) return -1;

    return yearB - yearA;  // Descending order
  });

  // Add rows from the CSV data
  projects.forEach(project => {
    const row = document.createElement('div');
    row.classList.add('faux-row');
    
   // Extract unique years from the data
const yearSet = new Set();

projects.forEach(project => {
  const year = project["Year Funded"];
  if (year && !isNaN(parseInt(year))) {
    yearSet.add(year);
  }
});
    
 // Extract unique states from the data
const stateSet = new Set();

projects.forEach(project => {
  const state = project["State"];
  if (state) {
    // If there are comma-separated states, split and add each
    state.split(",").forEach(s => stateSet.add(s.trim()));
  }
});

// Convert to array and sort alphabetically
const sortedStates = Array.from(stateSet).sort();

// Populate the stateFilter dropdown
const stateSelect = document.getElementById("projectState");
if (stateSelect) {
  stateSelect.innerHTML = `<option value="">Show All</option>`; // Clear existing

  sortedStates.forEach(state => {
    const option = document.createElement("option");
    option.value = state;
    option.textContent = state;
    stateSelect.appendChild(option);
  });
}   

// Convert to array and sort (most recent first)
const sortedYears = Array.from(yearSet).sort((a, b) => b - a);

// Populate the yearFilter dropdown
const yearSelect = document.getElementById("yearFilter");
if (yearSelect) {
  // Clear any existing options except "All Years"
  yearSelect.innerHTML = `<option value="">All Years</option>`;

  sortedYears.forEach(year => {
    const option = document.createElement("option");
    option.value = year;
    option.textContent = year;
    yearSelect.appendChild(option);
  });
} 

    // Set all drawer-related data attributes
    row.dataset.title = project["Project Title"] || '';
    row.dataset.goal = project["Project Goal"] || '';
    row.dataset.description = project["Project Description"] || '';
    row.dataset.hazard = project["Weather Hazard"] || '';
    row.dataset.benefits = project["Project Benefits"] || '';
    row.dataset.keywords = project["Combined Keywords"] || '';
    row.dataset.award = project["Award Number(s)"] || '';
    row.dataset.program = project["Managing WPO Program"] || '';
    row.dataset.performance = project["Period of Performance"] || '';
    row.dataset.pi = project["PI Last Name"] || '';
    row.dataset.orgs = project["Affiliations (Comma Separated)"] || '';
    row.dataset.partner = project["Transition Partner Spelled Out"];
    row.dataset.poc = project["Transition POC"] || '';
    row.dataset.outputlink = project["REACH URLs"] || '';
    row.dataset.icon = project["Weather Hazard Icon"] || '';
    row.dataset.state = project["State"] || '';
    row.dataset.hazard = project["Weather Hazard"] || '';
    row.dataset.combinedsearch = project["Combined Search"] || '';
    row.dataset.models = project["Associated Forecast Systems & Models"] || '';
    row.dataset.year = project["Year Funded"] || '';
    row.dataset.status = project["Project Status"] || '';

    row.innerHTML = `
      <div class="cell hazard-icon">${project["Weather Hazard Icon"]}</div>
      <div class="cell title"><strong>${project["Project Title"]}</strong><div>${project["Truncated Project Goal"]}</div></div>
      <div class="cell pi">${project["PI Last Name"]}</div>
      <div class="cell program">${project["Managing WPO Program"]}</div>
      <div class="cell status">${project["Status Icon"]}</div>
      <div class="cell year">${project["Year Funded"]}</div>
      <div class="cell link"><a href="${project["REACH URLs"]}" target="_blank">View Outputs</a></div>
    `;

    row.addEventListener("click", () => openDrawer(row));
    resultsContainer.appendChild(row);
    allRows.push(row);  // Add row to the allRows array for filtering
  });

  // Ensure all rows are visible initially
  allRows.forEach(row => row.style.display = 'grid');  // Make sure rows are displayed

  // Update the "Total Projects" widget with the total count of rows
  updateTotalProjectsWidget();

  // Call showPage to ensure pagination is initialized correctly
  showPage(1); // Display the first page (no filters applied yet)
}
  
let isPaginationClick = false;  
// Pagination
function showPage(page) {
  const container = document.querySelector('.results-container');
  const info = document.getElementById("pagination-info");
  const allRows = document.querySelectorAll('.faux-row');

  // If filteredRows is empty (not filtered yet), default to all rows
  const rowsToShow = filteredRows.length ? filteredRows : Array.from(allRows);

  // Hide all rows first
  allRows.forEach(row => row.style.display = 'none');

  // Show only rows on the current page
  rowsToShow
    .slice((page - 1) * itemsPerPage, page * itemsPerPage)
    .forEach(row => row.style.display = 'grid');

  currentPage = page;

  updatePaginationButtons(rowsToShow);

  info.textContent = `Showing ${(page - 1) * itemsPerPage + 1}–${Math.min(page * itemsPerPage, rowsToShow.length)} of ${rowsToShow.length} projects`;

  if (isPaginationClick) {
    container.scrollIntoView({ behavior: "smooth" });
    isPaginationClick = false;
  }
}

let filteredRows = [];  // Holds only the rows that match current filter
  
function filterTableByHazard() {
  const allRows = document.querySelectorAll('.faux-row');
  filteredRows = [];

  // Reset to page 1
  currentPage = 1;

  allRows.forEach(row => {
    const rowHazard = row.dataset.hazard || '';
    const matches = selectedHazards.length === 0 || selectedHazards.some(h => rowHazard.includes(h));

    if (matches) {
      row.style.display = 'grid';
      filteredRows.push(row);
    } else {
      row.style.display = 'none';
    }
  });

  document.getElementById("output-count").textContent = filteredRows.length;
  showPage(currentPage);
}
  
  function filterTable() {
  const searchQuery = document.getElementById("combinedSearch")?.value.toLowerCase().trim() || "";
  const programFilter = document.getElementById("programFilter").value;
  const yearFilter = document.getElementById("yearFilter").value;
  const allRows = document.querySelectorAll('.faux-row');
  const stateFilter = document.getElementById("projectState").value;

  filteredRows = [];
  currentPage = 1;

  const searchWords = searchQuery.split(/\s+/);

  allRows.forEach(row => {
    const rowCombinedSearch = row.dataset.combinedsearch?.toLowerCase() || '';
    const rowKeywordTags = row.dataset.keywords?.toLowerCase() || '';
    const rowModels = row.dataset.models?.toLowerCase() || '';
    const rowProgram = row.dataset.program || '';
    const rowStatus = row.dataset.status || '';
    const rowYear = row.dataset.year || '';
    const rowHazard = row.dataset.hazard || '';
    const rowState = row.dataset.state || '';
    const matchesState = !stateFilter || rowState
  .split(",")
  .map(s => s.trim())
  .includes(stateFilter);

    const matchesKeywordQuery = !searchQuery || searchWords.every(word =>
      rowCombinedSearch.includes(word)
    );

    const matchesKeywordTags = selectedKeywords.length === 0 || selectedKeywords.every(tag =>
      rowKeywordTags.includes(tag)
    );

    const matchesModelTags = selectedModels.length === 0 || selectedModels.every(model =>
      rowModels.includes(model)
    );

    const matchesHazard = selectedHazards.length === 0 || selectedHazards.some(h =>
      rowHazard.includes(h)
    );

    const matchesProgram = !programFilter || rowProgram === programFilter;
    const matchesYear = !yearFilter || rowYear === yearFilter;
    const matchesStatus = !selectedStatus || rowStatus === selectedStatus;

    if (
  matchesHazard &&
  matchesKeywordQuery &&
  matchesProgram &&
  matchesKeywordTags &&
  matchesModelTags &&
  matchesYear &&
  matchesStatus &&
  matchesState
) {
  row.style.display = 'grid';
  filteredRows.push(row);
} else {
  row.style.display = 'none';
}
  });

  document.getElementById("output-count").textContent = filteredRows.length;
  showPage(currentPage);
    
 // now toggle the table vs. “no results” message
  const resultsContainer = document.querySelector('.results-container');
  const paginationControls = document.getElementById('pagination');
  const paginationInfo = document.getElementById('pagination-info');
  const noResultsMsg = document.getElementById('noResultsMessage');

  if (filteredRows.length === 0) {
    resultsContainer.style.display = 'none';
    paginationControls.style.display = 'none';
    paginationInfo.style.display = 'none';
    noResultsMsg.style.display = 'block';
  } else {
    resultsContainer.style.display = 'block';
    paginationControls.style.display = '';
    paginationInfo.style.display = '';
    noResultsMsg.style.display = 'none';
  }
}   

function updatePaginationButtons(visibleRows) {
  const pagination = document.getElementById("pagination");
  pagination.innerHTML = '';  // Clear current pagination buttons
  
  const totalPages = Math.ceil(visibleRows.length / itemsPerPage);
  const maxVisiblePages = 5; // How many pages to show in the pagination controls
  const buffer = Math.floor(maxVisiblePages / 2); // Number of pages to show on each side of the current page

  // Previous button
  if (currentPage > 1) {
    const prevBtn = document.createElement('button');
    prevBtn.textContent = '« Prev';
    prevBtn.className = 'pagination-btn prev';
    prevBtn.onclick = () => {
      isPaginationClick = true;
      showPage(currentPage - 1);
    };
    pagination.appendChild(prevBtn);
  }

  // First page
  if (currentPage > buffer + 1) {
    createPageButton(1, pagination);
    pagination.appendChild(createEllipsis());
  }

  // Middle range of pages
  let startPage = Math.max(1, currentPage - buffer);
  let endPage = Math.min(totalPages, currentPage + buffer);

  if (currentPage <= buffer) {
    endPage = Math.min(totalPages, maxVisiblePages);
  }

  if (currentPage + buffer > totalPages) {
    startPage = Math.max(1, totalPages - maxVisiblePages + 1);
  }

  for (let i = startPage; i <= endPage; i++) {
    createPageButton(i, pagination);
  }

  // Last page
  if (endPage < totalPages - 1) {
    pagination.appendChild(createEllipsis());
    createPageButton(totalPages, pagination);
  }

  // Next button
  if (currentPage < totalPages) {
    const nextBtn = document.createElement('button');
    nextBtn.textContent = 'Next »';
    nextBtn.className = 'pagination-btn next';
    nextBtn.onclick = () => {
      isPaginationClick = true;
      showPage(currentPage + 1);
    };
    pagination.appendChild(nextBtn);
  }

  function createPageButton(page, container) {
    const btn = document.createElement('button');
    btn.textContent = page;
    btn.className = 'pagination-btn';
    if (page === currentPage) btn.classList.add('active');
    btn.onclick = () => {
      isPaginationClick = true;
      showPage(page);
    };
    container.appendChild(btn);
  }

  function createEllipsis() {
    const span = document.createElement('span');
    span.textContent = '…';
    span.className = 'pagination-ellipsis';
    return span;
  }
}

// Drawer Logic
function openDrawer(row) {
  if (selectedRow) selectedRow.classList.remove("selected");
  row.classList.add("selected");
  selectedRow = row;
  
   const weatherHazards = row.dataset.hazard ? row.dataset.hazard.split(',') : ['Unknown Hazard'];  // Get the hazards from the row
  const contextChipContainer = document.getElementById("drawer-context-chip");
  
  // Clear any existing chips
  contextChipContainer.innerHTML = '';

  // Create a chip for each hazard in the list
  weatherHazards.forEach(hazard => {
    const contextChip = document.createElement('div');
    contextChip.classList.add('drawer-context-chip');
    contextChip.textContent = hazard.trim();  // Trim spaces in case of extra spaces

    // Add appropriate hazard class based on the hazard type
    switch (hazard.trim()) {
      case 'Fire Weather':
        contextChip.classList.add('fire');
        break;
      case 'Water Extremes':
        contextChip.classList.add('water');
        break;
      case 'Extreme Temperatures':
        contextChip.classList.add('extreme-temps');
        break;
      case 'Tropical Cyclones':
        contextChip.classList.add('tropical');
        break;
      case 'Winter Weather':
        contextChip.classList.add('winter');
        break;
      case 'Air Quality':
        contextChip.classList.add('air-quality');
        break;
      case 'Relevant to All Hazards':
        contextChip.classList.add('all-hazards');
        break;
      default:
        contextChip.classList.add('severe');  // Default class if no match
        break;
    }

    // Append the new chip to the container
    contextChipContainer.appendChild(contextChip);
  });

  document.getElementById("drawerIcon").src = row.dataset.icon || '';
  document.getElementById("drawerTitle").textContent = row.dataset.title || '';
  document.getElementById("drawerGoal").textContent = row.dataset.goal || '';
  document.getElementById("drawerDescription").textContent = row.dataset.description || '';
  document.getElementById("drawerBenefits").textContent = row.dataset.benefits || '';
  document.getElementById("drawerAward").textContent = row.dataset.award || '';
  document.getElementById("drawerProgram").textContent = row.dataset.program || '';
  document.getElementById("drawerPeriod").textContent = row.dataset.performance || '';
  document.getElementById("drawerPIs").textContent = row.dataset.pi || '';
  document.getElementById("drawerOrgs").textContent = row.dataset.orgs || '';
  document.getElementById("drawerPOC").textContent = row.dataset.poc || '';
  document.getElementById("drawerPartner").textContent = row.dataset.partner || '';
  document.getElementById("drawerLink").href = row.dataset.outputlink || "#";
  document.getElementById("drawerState").textContent = row.dataset.state || '';

  const keywordsContainer = document.getElementById("drawerKeywords");
  keywordsContainer.innerHTML = '';
  if (row.dataset.keywords) {
    row.dataset.keywords.split(',').forEach(word => {
      const span = document.createElement('span');
      span.textContent = word.trim();
      keywordsContainer.appendChild(span);
    });
  }

  collapseAllSectionsExcept("detailsSection");
  document.getElementById("projectDrawer").classList.add("open");
}

function closeDrawer() {
  document.getElementById("projectDrawer").classList.remove("open");
  if (selectedRow) {
    selectedRow.classList.remove("selected");
    selectedRow = null;
  }
}

function collapseAllSectionsExcept(openSectionId) {
  document.querySelectorAll('.drawer-section.collapsible').forEach(section => {
    const body = section.querySelector('.collapsible-body');
    const icon = section.querySelector('.toggle-icon');
    if (section.id === openSectionId) {
      body.classList.remove('collapsed');
      icon.textContent = 'expand_less';
    } else {
      body.classList.add('collapsed');
      icon.textContent = 'expand_more';
    }
  });
}
  
function toggleCollapse(header) {
  const body = header.nextElementSibling;
  const icon = header.querySelector('.toggle-icon');
  body.classList.toggle('collapsed');
  icon.textContent = body.classList.contains('collapsed') ? 'expand_more' : 'expand_less';
}  

// Toggle filters
document.getElementById("toggleFilters").addEventListener("click", function () {
  const filters = document.getElementById("filtersPopout");
  filters.classList.toggle("show");
});

// Reset all filters and clear the selected hazards
function resetFilters() {
  // Clear text input and dropdown filters
  document.getElementById("combinedSearch").value = "";
  document.getElementById("programFilter").value = "";
  document.getElementById("projectStatus").value = "";
  document.getElementById("yearFilter").value = "";
  document.getElementById("projectState").value = "";

  // Clear keyword choices
  if (keywordChoices) {
    keywordChoices.removeActiveItems();
  }
  selectedKeywords = [];
  
  if (modelChoices) {
  modelChoices.removeActiveItems();
}
selectedModels = [];

  // Reset hazard selections
  selectedHazards = [];
  const hazardButtons = document.querySelectorAll('.hazard-button');
  hazardButtons.forEach(button => button.classList.remove('active'));

  // Hide the keyword dropdown if it’s visible
  const keywordOptions = document.getElementById("keywordOptions");
  if (keywordOptions) {
    keywordOptions.style.display = "none";
  }
  
  document.getElementById("projectStatus").value = "";

selectedStatus = "";
selectedYear = "";

  // Re-run filter logic
  filterTable();
}
  
 // All of your filter listeners go inside your DOMContentLoaded (or top‐level) scope:
document.addEventListener("DOMContentLoaded", () => {
  // Debounced search
  document
    .getElementById("combinedSearch")
    .addEventListener("input", debounce(() => filterTable(), 300));

  // Program & year filters
  document
    .getElementById("programFilter")
    .addEventListener("change", filterTable);

  document
    .getElementById("yearFilter")
    .addEventListener("change", filterTable);

  // Project Status (update selectedStatus then filter)
  document
    .getElementById("projectStatus")
    .addEventListener("change", () => {
      selectedStatus = document.getElementById("projectStatus").value;
      filterTable();
    });

  // State filter (top‐level, not nested)
  document
    .getElementById("projectState")
    .addEventListener("change", filterTable);

  // Click‐outside for your keyword dropdown
  document.addEventListener("click", function (e) {
    const dropdown = document.getElementById("keywordMultiSelect");
    if (dropdown && !dropdown.contains(e.target)) {
      document.getElementById("keywordOptions").style.display = "none";
    }
  });
});  // <-- only one closing here, for the DOMContentLoaded
  
  function debounce(func, delay) {
  let timeout;
  return function () {
    clearTimeout(timeout);
    timeout = setTimeout(() => func.apply(this, arguments), delay);
  };
}
  
  // Function to reset the 'Total Projects' widget
function updateTotalProjectsWidget() {
  const allRows = document.querySelectorAll('.faux-row');
  document.getElementById("output-count").textContent = allRows.length;  // Show total projects count
}
  
// Create a mapping for the button labels to dataset values
const hazardMapping = {
  "SEVERE": "Severe Weather",
  "EXTREME TEMPS": "Extreme Temperatures",
  "WATER": "Water Extremes",
  "FIRE": "Fire Weather",
  "TROPICAL": "Tropical Cyclones",
  "WINTER": "Winter Weather",
  "AIR QUALITY": "Air Quality",
  "ALL": "Relevant to All Hazards"
};

let selectedHazards = []; // Array to keep track of selected hazards

// Toggle hazard selection when a button is clicked
function toggleHazardButton(button, hazard) {
  const mappedHazard = hazardMapping[hazard];  // Get the mapped value for the hazard
  
  // Add the hazard to the list if it's not selected
  if (!selectedHazards.includes(mappedHazard)) {
    selectedHazards.push(mappedHazard); // Add selected hazard
    button.classList.add('active'); // Add active class
  } else {
    // Remove the hazard from the list if it's already selected
    selectedHazards = selectedHazards.filter(item => item !== mappedHazard);
    button.classList.remove('active'); // Remove active class
  }

  // Update table display after each change
  filterTable();
}

// Example event listeners for the hazard buttons
const allButton = document.querySelector('.hazard-button.all');
allButton.addEventListener('click', function() {
  toggleHazardButton(allButton, "ALL");
});

const severeButton = document.querySelector('.hazard-button.severe');
severeButton.addEventListener('click', function() {
  toggleHazardButton(severeButton, "SEVERE");
});

const extremeTempsButton = document.querySelector('.hazard-button.temps');
extremeTempsButton.addEventListener('click', function() {
  toggleHazardButton(extremeTempsButton, "EXTREME TEMPS");
});

const waterButton = document.querySelector('.hazard-button.water');
waterButton.addEventListener('click', function() {
  toggleHazardButton(waterButton, "WATER");
});

const fireButton = document.querySelector('.hazard-button.fire');
fireButton.addEventListener('click', function() {
  toggleHazardButton(fireButton, "FIRE");
});

const tropicalButton = document.querySelector('.hazard-button.tropical');
tropicalButton.addEventListener('click', function() {
  toggleHazardButton(tropicalButton, "TROPICAL");
});

const winterButton = document.querySelector('.hazard-button.winter');
winterButton.addEventListener('click', function() {
  toggleHazardButton(winterButton, "WINTER");
});

const airQualityButton = document.querySelector('.hazard-button.air-quality');
airQualityButton.addEventListener('click', function() {
  toggleHazardButton(airQualityButton, "AIR QUALITY");
});
  
document.getElementById("reset-btn").addEventListener("click", resetFilters);
  
let selectedKeywords = [];


  
</script>

   <script src="https://cdn.jsdelivr.net/npm/choices.js/public/assets/scripts/choices.min.js"></script>
<script>
document.addEventListener("DOMContentLoaded", function () {
  // Initialize Choices.js for keywordFilter
  keywordChoices = new Choices("#keywordFilter", {
    removeItemButton: true,
    searchEnabled: true,
    placeholderValue: 'Search by keyword',
    searchPlaceholderValue: 'Search keywords',
    shouldSort: false,
  });

  // Initialize Choices.js for modelFilter
  modelChoices = new Choices("#modelFilter", {
    removeItemButton: true,
    searchEnabled: true,
    placeholderValue: 'Search systems/models',
    searchPlaceholderValue: 'Search forecast systems/models',
    shouldSort: false,
  });

  // Handle keyword filter change
  document.getElementById("keywordFilter").addEventListener("change", () => {
    const selectedOptions = Array.from(document.getElementById("keywordFilter").selectedOptions);
    selectedKeywords = selectedOptions.map(opt => opt.value.toLowerCase());
    filterTable();
  });

  // Handle model filter change
  document.getElementById("modelFilter").addEventListener("change", () => {
    const selectedOptions = Array.from(document.getElementById("modelFilter").selectedOptions);
    selectedModels = selectedOptions.map(opt => opt.value.toLowerCase());
    filterTable();
  });

  // Add custom styling to optgroup headers
  setTimeout(() => {
    const groups = document.querySelectorAll('.choices__list--dropdown .choices__group');
    groups.forEach(group => group.classList.add('custom-optgroup-label'));
  }, 100);
});
</script>

</body>
</html>
